<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- üü¢ ÁΩëÁ´ôÂõæÊ†áËÆæÁΩÆ (Favicon) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öõÔ∏è</text></svg>">
    
    <title>Tom Shi</title>
    
    <!-- ÂºïÂÖ• Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        /* =========================================
           1. Apple Design System (ËÆæËÆ°ËßÑËåÉ)
           ========================================= */
        :root {
            --bg-color: #000000;
            --card-bg: #1d1d1f; /* ËãπÊûúÊ∑±Á©∫ÁÅ∞ */
            --text-primary: #f5f5f7;
            --text-secondary: #86868b;
            --accent-blue: #2997ff;
            --divider: #424245;
            --font-stack: "SF Pro Display", -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: var(--font-stack);
            overflow-x: hidden;
            /* ÈíõÈáëÂ±ûÊ∑±Á©∫ËÉåÊôØ */
            background-image: radial-gradient(circle at 50% 0%, #2a2a2e 0%, #000000 80%);
            min-height: 100vh;
        }

        /* È°∂ÈÉ®ÂØºËà™Ê†è */
        nav {
            position: sticky;
            top: 0; left: 0; width: 100%;
            height: 52px;
            background: rgba(29, 29, 31, 0.72);
            backdrop-filter: saturate(180%) blur(20px);
            -webkit-backdrop-filter: saturate(180%) blur(20px);
            z-index: 999;
            display: flex;
            justify-content: center;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        .nav-content {
            width: 980px; max-width: 92%;
            display: flex; justify-content: space-between; align-items: center;
            font-size: 12px;
        }
        .nav-logo { font-weight: 600; font-size: 14px; color: #fff; text-decoration: none; letter-spacing: 0.5px; }
        .nav-links { display: flex; gap: 24px; align-items: center; }
        .nav-item { color: #e8e8ed; text-decoration: none; opacity: 0.8; transition: 0.3s; cursor: pointer; }
        .nav-item:hover { opacity: 1; color: var(--accent-blue); }
        
        /* ËØ≠Ë®ÄÂàáÊç¢ÊåâÈíÆ */
        .lang-btn {
            font-size: 14px;
            background: rgba(255,255,255,0.1);
            padding: 4px 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.2s;
        }
        .lang-btn:hover { background: rgba(255,255,255,0.2); }

        .container {
            width: 980px;
            max-width: 90%;
            margin: 0 auto;
        }

        /* =========================================
           2. Hero Section
           ========================================= */
        .hero {
            padding: 140px 0 100px;
            text-align: center;
        }
        h1 {
            font-size: 64px;
            font-weight: 700;
            line-height: 1.05;
            letter-spacing: -0.015em;
            margin-bottom: 24px;
            /* ÈíõÈáëÂ±ûÂÖâÊ≥ΩÊ∏êÂèòÂ≠ó */
            background: linear-gradient(135deg, #ffffff 0%, #a1a1a6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .hero-desc {
            font-size: 24px;
            line-height: 1.4;
            font-weight: 400;
            color: var(--text-secondary);
            max-width: 640px;
            margin: 0 auto 40px;
        }

        /* =========================================
           3. Bento Grid
           ========================================= */
        .bento-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: auto;
            gap: 20px;
            margin-bottom: 80px;
        }

        .tile {
            background: var(--card-bg);
            border-radius: 28px;
            padding: 35px;
            position: relative;
            overflow: hidden;
            display: flex; flex-direction: column; justify-content: space-between;
            transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            min-height: 420px;
        }
        .tile:hover { transform: scale(1.02); z-index: 2; box-shadow: 0 30px 60px rgba(0,0,0,0.4); }

        .tile-large { grid-column: span 2; }
        .tile-small { grid-column: span 1; }

        .tile-subtitle { font-size: 11px; font-weight: 600; color: #86868b; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
        .tile-title { font-size: 32px; font-weight: 600; color: #f5f5f7; line-height: 1.1; margin-bottom: 15px; }
        .tile-text { font-size: 17px; color: #86868b; line-height: 1.6; font-weight: 400; white-space: pre-line; } /* pre-line ‰øùÊåÅÊç¢Ë°å */

        .counter-num {
            font-size: 68px; font-weight: 700; color: #fff;
            letter-spacing: -2px; margin-top: auto;
            font-variant-numeric: tabular-nums;
        }

        .contact-list {
            margin-top: auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .contact-btn {
            display: flex; align-items: center; justify-content: center;
            height: 50px;
            background: rgba(255,255,255,0.08);
            border-radius: 12px;
            color: #fff; text-decoration: none;
            font-size: 15px; font-weight: 500;
            transition: 0.2s;
        }
        .contact-btn:hover { background: #fff; color: #000; }

        .tag-container { display: flex; flex-direction: column; gap: 12px; margin-top: auto; }
        .tag {
            font-size: 15px; color: #f5f5f7; display: flex; align-items: center; gap: 8px;
            padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .tag:last-child { border: none; }

        /* =========================================
           4. Message Board
           ========================================= */
        .message-section {
            padding: 80px 0;
            background: #121212;
            border-radius: 32px;
            margin-bottom: 50px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .ios-input-group { position: relative; width: 100%; max-width: 520px; margin: 30px auto; }
        
        .ios-input {
            width: 100%;
            background: #252527;
            border: 1px solid #3a3a3c;
            padding: 18px 24px;
            padding-right: 60px;
            border-radius: 24px;
            color: white;
            font-size: 17px;
            outline: none;
            transition: 0.3s;
        }
        .ios-input:focus { border-color: var(--accent-blue); background: #2c2c2e; }
        
        .ios-send-btn {
            position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
            width: 36px; height: 36px;
            background: var(--accent-blue);
            border-radius: 50%;
            border: none;
            color: white;
            font-weight: 600; cursor: pointer;
            transition: 0.2s;
        }
        .ios-send-btn:hover { transform: translateY(-50%) scale(1.05); }

        .message-list {
            max-width: 520px; margin: 0 auto; text-align: left;
            display: flex; flex-direction: column; gap: 16px;
        }
        .msg-bubble {
            background: #252527;
            padding: 14px 20px;
            border-radius: 20px;
            border-bottom-left-radius: 4px;
            color: #f5f5f7;
            font-size: 16px;
            line-height: 1.4;
            align-self: flex-start;
            max-width: 90%;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { from { opacity: 0; transform: scale(0.9) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }

        footer {
            padding: 40px 0;
            text-align: center;
            color: #6e6e73;
            font-size: 12px;
        }

        @media (max-width: 768px) {
            h1 { font-size: 40px; }
            .bento-grid { grid-template-columns: 1fr; }
            .tile-large, .tile-small { grid-column: span 1; }
            .tile { min-height: 300px; height: auto; }
            .contact-list { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <!-- ÂØºËà™ -->
    <nav>
        <div class="nav-content">
            <a href="#" class="nav-logo">Tom Shi</a>
            <div class="nav-links">
                <a href="#about" class="nav-item" data-i18n="nav_about">About</a>
                <a href="#contact" class="nav-item" data-i18n="nav_contact">Contact</a>
                <a href="#board" class="nav-item" data-i18n="nav_msg">Messages</a>
                <div class="lang-btn" onclick="toggleLanguage()">üåè</div>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Hero -->
        <section class="hero">
            <h1 class="gsap-hero">Tom Shi.</h1>
            <p class="hero-desc gsap-hero" data-i18n="hero_desc">
                Developer. Thinker. Explorer.
            </p>
        </section>

        <!-- Bento Grid -->
        <div id="about" class="bento-grid">
            
            <!-- 1. ÁÆÄ‰ªã -->
            <div class="tile tile-large scroll-fade">
                <div>
                    <div class="tile-subtitle">Profile</div>
                    <div class="tile-title" data-i18n="profile_title">Hard Roads in Shu.</div>
                    <div class="tile-text" data-i18n="profile_text">
                        Golden cups of pure wine cost ten thousand a measure,
                        Jade plates of rare dainties cost ten thousand a coin.
                        I lay down my cup and chopsticks, I cannot eat,
                        I draw my sword and look around, my mind is blank.
                        I want to cross the Yellow River, but ice chokes the ferry,
                        I want to climb the Taihang Mountains, but snow fills the sky.
                        Idly I fish by the green stream,
                        Suddenly I dream of sailing a boat towards the sun.
                        Hard is the way, hard is the way,
                        So many cross-roads, where am I now?
                        A time will come to ride the wind and cleave the waves,
                        To set my cloud-white sail and cross the blue ocean.
                    </div>
                </div>
            </div>

            <!-- 2. ËÆ°Êï∞Âô® -->
            <div class="tile tile-small scroll-fade" style="background: #000; border: 1px solid #333;">
                <div class="tile-subtitle" style="color: var(--accent-blue);">Real-time</div>
                <div class="tile-title" data-i18n="stats_title">Observers</div>
                <div class="counter-num" id="visit-count">----</div>
            </div>

            <!-- 3. Êé¢Á¥¢È¢ÜÂüü -->
            <div class="tile tile-small scroll-fade">
                <div class="tile-subtitle">Interests</div>
                <div class="tile-title" data-i18n="interests_title">Focus</div>
                <div class="tag-container">
                    <div class="tag"><span style="color: #bf5af2">‚öõÔ∏è</span> Physics</div>
                    <div class="tag"><span style="color: #0a84ff">üíª</span> Web Development</div>
                    <div class="tag"><span style="color: #ff375f">üöÄ</span> Space Exploration</div>
                </div>
            </div>

            <!-- 4. ‰øùÊåÅËÅîÁªú -->
            <div class="tile tile-large scroll-fade" id="contact" style="background: linear-gradient(135deg, #1d1d1f 0%, #2c2c2e 100%);">
                <div>
                    <div class="tile-subtitle">Connect</div>
                    <div class="tile-title" data-i18n="connect_title">Get in Touch.</div>
                    <div class="tile-text" data-i18n="connect_text">Open to collaborations and interesting conversations.</div>
                </div>
                <div class="contact-list">
                    <a href="https://tomshi.online" target="_blank" class="contact-btn" data-i18n="btn_website">Website ‚Üó</a>
                    <a href="mailto:tom11s@outlook.com" class="contact-btn" data-i18n="btn_email">Email ‚Üó</a>
                    <a href="https://www.instagram.com/tom.11s?igsh=MW5sb2VuajlkMzY3Nw==" target="_blank" class="contact-btn" data-i18n="btn_ins">Instagram ‚Üó</a>
                    <a href="#" class="contact-btn" style="opacity: 0.5; cursor: default;" data-i18n="btn_more">More...</a>
                </div>
            </div>

        </div>

        <!-- ÁïôË®ÄÊùø -->
        <div id="board" class="message-section scroll-fade">
            <h2 style="font-size: 32px; font-weight: 600; margin-bottom: 10px; color: #f5f5f7;" data-i18n="msg_title">Message Board</h2>
            <p style="color: #86868b; margin-bottom: 30px;" data-i18n="msg_desc">Leave a note. It stays in the cloud.</p>

            <div class="ios-input-group">
                <input type="text" id="msg-input" class="ios-input" placeholder="Type a message..." onkeypress="if(event.keyCode==13) sendMsg()">
                <button class="ios-send-btn" onclick="sendMsg()">‚Üë</button>
            </div>

            <div id="msg-list" class="message-list">
                <div style="text-align: center; color: #444;" data-i18n="loading">Loading...</div>
            </div>
        </div>

        <footer>
            Copyright ¬© <span id="year"></span> Tom Shi. All rights reserved.
        </footer>
    </div>

    <!-- ÂºïÂÖ• GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <!-- ÈÄªËæëËÑöÊú¨ -->
    <script>
        // üî¥üî¥üî¥ Supabase ÈÖçÁΩÆ
        const CONFIG = {
            url: 'https://fznfneqwxzuwtognuoeo.supabase.co',
            key: 'sb_publishable_UlNMDLt4OaYIX-_lCezGwA_8jIQLhFO'
        };

        // üåê Â§öËØ≠Ë®ÄÈÖçÁΩÆÂ∫ì
        const i18n = {
            en: {
                nav_about: "About",
                nav_contact: "Contact",
                nav_msg: "Messages",
                hero_desc: "Developer. Thinker. Explorer.",
                profile_title: "Hard Roads in Shu.",
                profile_text: "Golden cups of pure wine cost ten thousand a measure,\nJade plates of rare dainties cost ten thousand a coin.\nI lay down my cup and chopsticks, I cannot eat,\nI draw my sword and look around, my mind is blank.\nI want to cross the Yellow River, but ice chokes the ferry,\nI want to climb the Taihang Mountains, but snow fills the sky.\nIdly I fish by the green stream,\nSuddenly I dream of sailing a boat towards the sun.\nHard is the way, hard is the way,\nSo many cross-roads, where am I now?\nA time will come to ride the wind and cleave the waves,\nTo set my cloud-white sail and cross the blue ocean.",
                stats_title: "Observers",
                interests_title: "Focus",
                connect_title: "Get in Touch.",
                connect_text: "Open to collaborations and interesting conversations.",
                msg_title: "Message Board",
                msg_desc: "Leave a note. It stays in the cloud.",
                loading: "Loading...",
                no_msg: "No messages yet.",
                db_error: "(Database not connected)",
                send_fail: "Send failed.",
                input_ph: "Type a message...",
                btn_website: "Website ‚Üó",
                btn_email: "Email ‚Üó",
                btn_ins: "Instagram ‚Üó",
                btn_more: "More..."
            },
            zh: {
                nav_about: "ÂÖ≥‰∫é",
                nav_contact: "ËÅîÁ≥ª",
                nav_msg: "ÁïôË®Ä",
                hero_desc: "Developer. Thinker. Explorer.",
                profile_title: "Ë°åË∑ØÈöæ¬∑ÂÖ∂‰∏Ä",
                profile_text: "ÈáëÊ®ΩÊ∏ÖÈÖíÊñóÂçÅÂçÉÔºåÁéâÁõòÁèçÁæûÁõ¥‰∏áÈí±„ÄÇ\nÂÅúÊùØÊäïÁÆ∏‰∏çËÉΩÈ£üÔºåÊãîÂâëÂõõÈ°æÂøÉËå´ÁÑ∂„ÄÇ\nÊ¨≤Ê∏°ÈªÑÊ≤≥ÂÜ∞Â°ûÂ∑ùÔºåÂ∞ÜÁôªÂ§™Ë°åÈõ™Êª°Â±±„ÄÇ\nÈó≤Êù•ÂûÇÈíìÁ¢ßÊ∫™‰∏äÔºåÂøΩÂ§ç‰πòËàüÊ¢¶Êó•Ëæπ„ÄÇ\nË°åË∑ØÈöæÔºåË°åË∑ØÈöæÔºåÂ§öÊ≠ßË∑ØÔºå‰ªäÂÆâÂú®Ôºü\nÈïøÈ£éÁ†¥Êµ™‰ºöÊúâÊó∂ÔºåÁõ¥ÊåÇ‰∫ëÂ∏ÜÊµéÊ≤ßÊµ∑„ÄÇ",
                stats_title: "ËÆøÂÆ¢ËßÇÊµã",
                interests_title: "ËÅöÁÑ¶",
                connect_title: "‰øùÊåÅËÅîÁªú„ÄÇ",
                connect_text: "ÈöèÊó∂Ê¨¢Ëøé‰∫§ÊµÅÊäÄÊúØ„ÄÅÁâ©ÁêÜÊàñ‰ªª‰ΩïÊúâË∂£ÁöÑÊÉ≥Ê≥ï„ÄÇ",
                msg_title: "ÁïôË®ÄÊùø",
                msg_desc: "‰Ω†ÁöÑÂ£∞Èü≥Ôºå‰∫ëÁ´ØÊ∞∏Â≠ò„ÄÇ",
                loading: "Ê≠£Âú®Âä†ËΩΩ...",
                no_msg: "ÊöÇÊó†ÁïôË®ÄÔºåÊä¢‰∏™Ê≤ôÂèëÔºü",
                db_error: "(ÊöÇÊú™ËøûÊé•Êï∞ÊçÆÂ∫ì)",
                send_fail: "ÂèëÈÄÅÂ§±Ë¥•„ÄÇ",
                input_ph: "ÂÜô‰∏ã‰Ω†ÁöÑÊÉ≥Ê≥ï...",
                btn_website: "‰∏™‰∫∫ÁΩëÁ´ô ‚Üó",
                btn_email: "ÁîµÂ≠êÈÇÆÁÆ± ‚Üó",
                btn_ins: "Instagram ‚Üó",
                btn_more: "Êõ¥Â§ö..."
            }
        };

        let currentLang = 'en'; // ÈªòËÆ§Ëã±ËØ≠

        // Ëá™Âä®Ê£ÄÊµãËØ≠Ë®Ä
        function detectLanguage() {
            const userLang = navigator.language || navigator.userLanguage;
            if (userLang.startsWith('zh')) {
                setLanguage('zh');
            } else {
                setLanguage('en');
            }
        }

        // ÂàáÊç¢ËØ≠Ë®Ä
        function toggleLanguage() {
            setLanguage(currentLang === 'en' ? 'zh' : 'en');
        }

        // ËÆæÁΩÆËØ≠Ë®ÄÊ†∏ÂøÉÂáΩÊï∞
        function setLanguage(lang) {
            currentLang = lang;
            const content = i18n[lang];
            
            // Êõ¥Êñ∞ÊâÄÊúâÂ∏¶ data-i18n ÁöÑÂÖÉÁ¥†
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (content[key]) el.innerText = content[key]; // ‰ΩøÁî® innerText ‰ª•‰øùÁïôÊç¢Ë°å
            });

            // Êõ¥Êñ∞ËæìÂÖ•Ê°Ü placeholder
            const input = document.getElementById('msg-input');
            if (input) input.placeholder = content.input_ph;

            // ÈáçÊñ∞Âä†ËΩΩÊ∂àÊÅØÊèêÁ§∫
            if (!sb) {
                const list = document.getElementById('msg-list');
                if (list) list.innerHTML = `<div style="text-align: center; color: #444; font-size: 13px;">${content.db_error}</div>`;
            }
        }

        // -------------------------
        // ÂéüÊúâÈÄªËæë‰øùÊåÅ‰∏çÂèò
        // -------------------------
        document.getElementById('year').innerText = new Date().getFullYear();
        let sb = null;

        function initSupabase() {
            if (!CONFIG.url || CONFIG.url.includes('‰Ω†ÁöÑURL')) return null;
            try { return supabase.createClient(CONFIG.url, CONFIG.key); } catch (e) { return null; }
        }

        window.onload = () => {
            detectLanguage(); // 1. ÂÖàËÆæÁΩÆËØ≠Ë®Ä
            initAnimations(); // 2. Âä®Áîª
            sb = initSupabase(); // 3. ËøûÊé•Êï∞ÊçÆÂ∫ì

            if (sb) {
                initStats();
                loadMessages();
            } else {
                setLanguage(currentLang); // Âà∑Êñ∞ÈîôËØØÊèêÁ§∫ÊñáÊú¨
            }
        };

        function initAnimations() {
            gsap.registerPlugin(ScrollTrigger);
            gsap.from(".gsap-hero", { opacity: 0, y: 30, duration: 1, stagger: 0.2, ease: "power3.out" });
            gsap.utils.toArray('.scroll-fade').forEach(el => {
                gsap.from(el, { scrollTrigger: { trigger: el, start: "top 85%" }, opacity: 0, y: 40, duration: 0.8, ease: "power3.out" });
            });
        }

        async function initStats() {
            try {
                await sb.rpc('increment_visits', { page_id: 'home_page' });
                const { data } = await sb.from('site_stats').select('visits').eq('id', 'home_page').single();
                if (data) {
                    const el = document.getElementById('visit-count');
                    let obj = { val: 0 };
                    gsap.to(obj, { val: data.visits, duration: 2, ease: "power4.out", onUpdate: () => el.innerText = Math.floor(obj.val).toLocaleString() });
                }
            } catch(e) {}
        }

        async function loadMessages() {
            const list = document.getElementById('msg-list');
            const { data } = await sb.from('messages').select('*').order('created_at', { ascending: false }).limit(10);
            
            if (!data || data.length === 0) {
                list.innerHTML = `<div style="text-align: center; color: #444;">${i18n[currentLang].no_msg}</div>`;
                return;
            }

            list.innerHTML = data.map(msg => `
                <div class="msg-bubble">
                    ${msg.content.replace(/</g, "&lt;")}
                    <span class="msg-time">${new Date(msg.created_at).toLocaleDateString()}</span>
                </div>
            `).join('');
        }

        async function sendMsg() {
            if (!sb) { alert('Please configure Supabase Key first.'); return; }
            const input = document.getElementById('msg-input');
            const text = input.value.trim();
            if(!text) return;

            const { error } = await sb.from('messages').insert({ content: text });
            if (!error) {
                input.value = '';
                loadMessages();
            } else {
                alert(i18n[currentLang].send_fail);
            }
        }
    </script>
</body>
</html>
