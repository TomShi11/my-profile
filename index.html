<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tom Shi</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        /* =========================================
           1. Apple Design System (è®¾è®¡è§„èŒƒ)
           ========================================= */
        :root {
            --bg-color: #000000;
            --card-bg: #161617; /* è‹¹æœå®˜ç½‘å¸¸ç”¨çš„æ·±ç° */
            --text-primary: #f5f5f7;
            --text-secondary: #86868b;
            --accent-blue: #2997ff;
            --divider: rgba(255,255,255,0.1);
            --font-stack: "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: var(--font-stack);
            overflow-x: hidden;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  (æ¯›ç»ç’ƒ) */
        nav {
            position: fixed;
            top: 0; left: 0; width: 100%;
            height: 48px;
            background: rgba(0,0,0,0.8);
            backdrop-filter: saturate(180%) blur(20px);
            -webkit-backdrop-filter: saturate(180%) blur(20px);
            z-index: 999;
            display: flex;
            justify-content: center;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .nav-content {
            width: 1000px; max-width: 90%;
            display: flex; justify-content: space-between; align-items: center;
            font-size: 12px; color: #e8e8ed;
        }
        .nav-logo { font-weight: 600; letter-spacing: 0.5px; opacity: 0.8; transition: 0.3s; }
        .nav-logo:hover { opacity: 1; }
        .nav-links { display: flex; gap: 24px; }
        .nav-item { cursor: pointer; color: #e8e8ed; transition: 0.3s; text-decoration: none; opacity: 0.8; }
        .nav-item:hover { opacity: 1; color: var(--accent-blue); }

        /* é€šç”¨å®¹å™¨ */
        .container {
            width: 1000px;
            max-width: 88%;
            margin: 0 auto;
        }

        /* =========================================
           2. Hero Section (é¦–å±å¤§å­—)
           ========================================= */
        .hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding-top: 60px;
        }

        /* æè‡´çš„æ’ç‰ˆ */
        h1 {
            font-size: 5rem; /* å·¨å¤§å­—å· */
            font-weight: 600;
            line-height: 1.05;
            letter-spacing: -0.015em;
            background: linear-gradient(180deg, #fff 0%, #a1a1a6 100%); /* é’›é‡‘å±æ¸å˜ */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            opacity: 0; /* åˆå§‹éšè—ï¼Œäº¤ç»™GSAP */
            transform: translateY(30px);
        }

        .hero-desc {
            font-size: 1.7rem;
            color: var(--text-secondary);
            font-weight: 400;
            max-width: 600px;
            line-height: 1.4;
            opacity: 0;
            transform: translateY(30px);
        }

        /* é‚£ä¸ªâ€œäº†è§£æ›´å¤šâ€çš„é“¾æ¥ */
        .cta-link {
            margin-top: 30px;
            color: var(--accent-blue);
            font-size: 1.2rem;
            text-decoration: none;
            display: flex; align-items: center; gap: 5px;
            opacity: 0;
            transform: translateY(20px);
        }
        .cta-link:hover { text-decoration: underline; }

        /* =========================================
           3. Bento Grid (ä¾¿å½“ç›’å¸ƒå±€)
           ========================================= */
        .grid-section {
            padding: 100px 0;
            background: #000;
        }

        .bento-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 400px);
            gap: 24px;
        }

        /* å¡ç‰‡åŸºç¡€ */
        .tile {
            background: var(--card-bg);
            border-radius: 30px;
            padding: 40px;
            position: relative;
            overflow: hidden;
            transition: transform 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .tile:hover { transform: scale(1.02); }

        /* å¡ç‰‡æ ‡é¢˜ä½“ç³» */
        .tile-subtitle { font-size: 12px; font-weight: 600; color: #86868b; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 10px; }
        .tile-title { font-size: 28px; font-weight: 600; color: #f5f5f7; line-height: 1.2; }
        .tile-text { font-size: 17px; color: #86868b; margin-top: 10px; line-height: 1.5; }

        /* ç‰¹æ®Šå¡ç‰‡æ ·å¼ */
        .tile-large { grid-column: span 2; } /* å®½å¡ç‰‡ */
        
        /* è®¡æ•°å™¨å¡ç‰‡ */
        .counter-display {
            font-size: 80px; font-weight: 700;
            color: #fff;
            letter-spacing: -2px;
            margin-top: auto;
        }

        /* æ ‡ç­¾ç»„ */
        .pill-group { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px; }
        .pill {
            padding: 8px 16px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            font-size: 14px;
            color: #f5f5f7;
            font-weight: 500;
        }

        /* =========================================
           4. Message Board (iMessage é£æ ¼)
           ========================================= */
        .message-section {
            padding: 100px 0;
            background: #000;
            border-top: 1px solid var(--divider);
        }

        .ios-input-group {
            position: relative;
            width: 100%; max-width: 600px; margin: 40px auto;
        }
        
        /* è‹¹æœé£è¾“å…¥æ¡† */
        .ios-input {
            width: 100%;
            background: #1c1c1e;
            border: 1px solid #333;
            padding: 18px 20px;
            padding-right: 50px;
            border-radius: 12px;
            color: white;
            font-size: 17px;
            outline: none;
            transition: 0.3s;
        }
        .ios-input:focus { border-color: var(--accent-blue); box-shadow: 0 0 0 4px rgba(41, 151, 255, 0.15); }

        .ios-send-btn {
            position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
            width: 30px; height: 30px;
            background: var(--accent-blue);
            border-radius: 50%;
            border: none;
            color: white;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: 0.2s;
        }
        .ios-send-btn:hover { background: #0077ED; }

        .message-list {
            max-width: 600px; margin: 0 auto;
            display: flex; flex-direction: column; gap: 20px;
        }
        
        .msg-bubble {
            background: #1c1c1e;
            padding: 16px 20px;
            border-radius: 20px;
            border-bottom-left-radius: 4px; /* æ°”æ³¡è§’ */
            color: #f5f5f7;
            font-size: 16px;
            line-height: 1.5;
            align-self: flex-start;
            max-width: 80%;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .msg-date {
            font-size: 12px; color: #555; margin-top: 5px; display: block;
        }

        @keyframes popIn { from { opacity: 0; transform: scale(0.9) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }

        /* =========================================
           5. Footer
           ========================================= */
        footer {
            padding: 50px 0;
            border-top: 1px solid var(--divider);
            text-align: center;
            color: var(--text-secondary);
            font-size: 12px;
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            h1 { font-size: 3.5rem; }
            .bento-grid { grid-template-columns: 1fr; grid-template-rows: auto; }
            .tile-large { grid-column: span 1; }
            .tile { min-height: 300px; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="nav-content">
            <div class="nav-logo">Tom Shi</div>
            <div class="nav-links">
                <a href="#about" class="nav-item">å…³äº</a>
                <a href="#board" class="nav-item">ç•™è¨€</a>
                <a href="mailto:tom11s@outlook.com" class="nav-item">è”ç³»</a>
            </div>
        </div>
    </nav>

    <section class="hero">
        <h1 class="gsap-hero">Tom Shi.</h1>
        <h1 class="gsap-hero" style="background: linear-gradient(180deg, #86868b 0%, #3e3e42 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Developer. Thinker.</h1>
        <p class="hero-desc gsap-hero">
            æ¢ç´¢ç‰©ç†æ³•åˆ™ä¸æ•°å­—é€»è¾‘çš„è¾¹ç•Œã€‚<br>
            ä»¥æç®€ä»£ç ï¼Œæ„å»ºå¤æ‚ä¸–ç•Œã€‚
        </p>
        <a href="#about" class="cta-link gsap-hero">è¿›ä¸€æ­¥äº†è§£ ></a>
    </section>

    <section id="about" class="grid-section">
        <div class="container">
            <div class="bento-grid">
                
                <div class="tile tile-large scroll-fade">
                    <div class="tile-subtitle">ç®€ä»‹</div>
                    <div class="tile-title">ä¸ä»…ä»…æ˜¯ä»£ç ã€‚</div>
                    <div class="tile-text">
                        æˆ‘æ˜¯ä¸€åçƒ­è¡·äºç‰©ç†å­¦å’Œ Web å¼€å‘çš„ç‹¬ç«‹åˆ›é€ è€…ã€‚æˆ‘ç›¸ä¿¡æœ€å¥½çš„æŠ€æœ¯åº”å½“åƒé­”æ³•ä¸€æ ·ï¼Œä¸ä»…è¿è¡Œç²¾ç¡®ï¼Œè€Œä¸”ä¼˜é›…ã€æ— æ„Ÿã€‚
                    </div>
                    <div class="pill-group">
                        <span class="pill">Physics</span>
                        <span class="pill">Web Development</span>
                        <span class="pill">Mathematics</span>
                    </div>
                </div>

                <div class="tile scroll-fade" style="background: #000; border: 1px solid #333;">
                    <div>
                        <div class="tile-subtitle" style="color: var(--accent-blue);">å®æ—¶è§‚æµ‹</div>
                        <div class="tile-title">è®¿å®¢æ•°æ®</div>
                    </div>
                    <div class="counter-display" id="visit-count">----</div>
                </div>

                <div class="tile scroll-fade">
                    <div class="tile-subtitle">è¿æ¥</div>
                    <div class="tile-title">ä¿æŒè”ç»œã€‚</div>
                    <div style="margin-top: 30px; display: flex; flex-direction: column; gap: 15px;">
                        <a href="https://tomshi.online" target="_blank" style="text-decoration: none; color: white; font-size: 18px; border-bottom: 1px solid #333; padding-bottom: 10px;">ä¸ªäººä¸»é¡µ â†—</a>
                        <a href="mailto:tom11s@outlook.com" style="text-decoration: none; color: white; font-size: 18px; border-bottom: 1px solid #333; padding-bottom: 10px;">å‘é€é‚®ä»¶ â†—</a>
                        <a href="https://www.instagram.com/tom.11s?igsh=MW5sb2VuajlkMzY3Nw==" target="_blank" style="text-decoration: none; color: white; font-size: 18px;">Instagram â†—</a>
                    </div>
                </div>

                <div class="tile tile-large scroll-fade" style="background: linear-gradient(135deg, #1c1c1e 0%, #2c2c2e 100%);">
                    <div class="tile-subtitle">ç†å¿µ</div>
                    <div class="tile-title">Think Different.</div>
                    <div class="tile-text">
                        "The people who are crazy enough to think they can change the world are the ones who do."
                    </div>
                </div>

            </div>
        </div>
    </section>

    <section id="board" class="message-section">
        <div class="container">
            <div style="text-align: center; margin-bottom: 60px;" class="scroll-fade">
                <h2 style="font-size: 48px; font-weight: 600;">ç•™è¨€æ¿.</h2>
                <p style="color: var(--text-secondary); margin-top: 10px;">ä½ çš„å£°éŸ³ï¼Œäº‘ç«¯æ°¸å­˜ã€‚</p>
            </div>

            <div class="ios-input-group scroll-fade">
                <input type="text" id="msg-input" class="ios-input" placeholder="è¾“å…¥æ¶ˆæ¯..." onkeypress="if(event.keyCode==13) sendMsg()">
                <button class="ios-send-btn" onclick="sendMsg()">â†‘</button>
            </div>

            <div id="msg-list" class="message-list">
                <div style="text-align: center; color: #333;">Loading...</div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            Copyright Â© 2024 Tom Shi. All rights reserved. <br>
            Designed in Apple Style.
        </div>
    </footer>

    <script>
        // ğŸ”´ğŸ”´ğŸ”´ å¡«å…¥ Supabase Key (ä¿ç•™å•å¼•å·)
        const CONFIG = {
            url: 'ä½ çš„URL',
            key: 'ä½ çš„ANON_KEY'
        };

        const sb = supabase.createClient(CONFIG.url, CONFIG.key);

        // 1. åŠ¨æ•ˆå¼•æ“ (GSAP Animation)
        window.onload = () => {
            gsap.registerPlugin(ScrollTrigger);

            // Hero è¿›åœºåŠ¨ç”»
            gsap.to(".gsap-hero", {
                opacity: 1,
                y: 0,
                duration: 1,
                stagger: 0.2, // é€ä¸ªå‡ºç°
                ease: "power3.out"
            });

            // æ»šåŠ¨æ¸å…¥åŠ¨ç”»
            gsap.utils.toArray('.scroll-fade').forEach(el => {
                gsap.from(el, {
                    scrollTrigger: {
                        trigger: el,
                        start: "top 85%", // å½“å…ƒç´ é¡¶éƒ¨åˆ°è¾¾è§†å£ 85% å¤„è§¦å‘
                        toggleActions: "play none none reverse"
                    },
                    opacity: 0,
                    y: 50,
                    duration: 0.8,
                    ease: "power3.out"
                });
            });

            initData();
            loadMessages();
        };

        // 2. è®¡æ•°å™¨é€»è¾‘
        async function initData() {
            try {
                await sb.rpc('increment_visits', { page_id: 'home_page' });
                const { data } = await sb.from('site_stats').select('visits').eq('id', 'home_page').single();
                
                if (data) {
                    const el = document.getElementById('visit-count');
                    let obj = { val: 0 };
                    // æ•°å­—æ»šåŠ¨åŠ¨ç”»
                    gsap.to(obj, {
                        val: data.visits,
                        duration: 2,
                        ease: "power4.out",
                        onUpdate: () => el.innerText = Math.floor(obj.val).toLocaleString() // åŠ åƒåˆ†ä½é€—å·
                    });
                }
            } catch(e) {}
        }

        // 3. ç•™è¨€æ¿é€»è¾‘
        async function loadMessages() {
            const list = document.getElementById('msg-list');
            const { data, error } = await sb.from('messages').select('*').order('created_at', { ascending: false }).limit(10);
            
            if (error) {
                list.innerHTML = '<div style="text-align:center; color:#333;">æ— æ³•è¿æ¥æœåŠ¡å™¨</div>';
                return;
            }

            list.innerHTML = data.map(msg => `
                <div class="msg-bubble">
                    ${msg.content.replace(/</g, "&lt;")}
                    <span class="msg-date">${new Date(msg.created_at).toLocaleDateString()}</span>
                </div>
            `).join('');
        }

        async function sendMsg() {
            const input = document.getElementById('msg-input');
            const text = input.value.trim();
            if(!text) return;

            const { error } = await sb.from('messages').insert({ content: text });
            if (!error) {
                input.value = '';
                loadMessages();
            } else {
                alert('å‘é€å¤±è´¥');
            }
        }
    </script>
</body>
</html>
